<!DOCTYPE html>
<html>

<head>
  <title></title>
  <img id ='i' src='test.jpg' width=320 height=240>
  <br>
  <canvas id='c' width=224 height=224 style="border:3px solid #f00"></canvas>
</head>

<body>
  <script>
  window.onload = function () {
    var c = document.getElementById("c");
    var i = document.getElementById("i");
    rotateImg(i, c, 90);
  }

  function rotateImg(i, c, degrees) {
    var ctx = c.getContext("2d");
    ctx.translate(c.width / 2, c.height / 2);
    ctx.rotate(degrees * 0.0174532925199432957);
    ctx.translate(-c.width / 2, -c.height / 2);
    drawImg(i, c);
  }


  function drawImg(i, c) {
    var ctx = c.getContext("2d");
    var iw = i.naturalWidth;
    var ih = i.naturalHeight;
    var cw = c.width;
    var ch = c.height;
    var sx = 0;
    var sy = 0;
    var cRatio = cw / ch;
    //*
    if (iw >= ih) {
      sx = (iw - (ih * cRatio)) / 2;
      iw = ih * cRatio;
    } else {
      sy = (ih - (iw * cRatio)) / 2
      ih = iw * cRatio;
    }
    //*/
    ctx.drawImage(i, sx, sy, iw, ih, 0, 0, cw, ch);
  }
  </script>
</body>

</html>