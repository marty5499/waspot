<!DOCTYPE html>
<html>

<head>
  <title></title>
  <img id ='i' src='test.jpg' width=320 height=240>
  <br>
  <canvas id='c' width=240 height=320 style="border:3px solid #f00"></canvas>
</head>

<body>
  <script>
  window.onload = function () {
    var c = document.getElementById("c");
    var i = document.getElementById("i");
    var d = 90;
    rotateImg(i, c, d, false, false);
    /*
    setInterval(function () {
      if (d++ <= 90) {
        rotateImg(i, c, d,false,false);
      }
    }, 500);
    //*/
  }

  function rotateImg(i, c, degrees, isVideo) {
    var ctx = c.getContext("2d");
    var iw = i.naturalWidth;
    var ih = i.naturalHeight;
    var cw = c.width;
    var ch = c.height;
    var iRatio = parseInt(100 * iw / ih) / 100;
    var cRatio = parseInt(100 * cw / ch) / 100;

    if (c.width != c.height && (cRatio != iRatio)) {
      ctx.translate(c.width / 2, c.height / 2);
      ctx.rotate(degrees * 0.0174532925199432957);
      ctx.translate(-c.height / 2, -c.width / 2);
      ctx.drawImage(i, 0, 0, i.width, i.height, 0, 0, c.height, c.width);
    } else {
      ctx.translate(c.width / 2, c.height / 2);
      ctx.rotate(degrees * 0.0174532925199432957);
      ctx.translate(-c.width / 2, -c.height / 2);
      drawImg(i, c);
    }
  }


  function drawImg(i, c, isVideo, keepRatio) {
    var ctx = c.getContext("2d");
    var iw = i.naturalWidth;
    var ih = i.naturalHeight;
    var cw = c.width;
    var ch = c.height;
    var sx = 0;
    var sy = 0;
    var cRatio = cw / ch;
    //*
    if (iw >= ih) {
      sx = (iw - (ih * cRatio)) / 2;
      iw = ih * cRatio;
    } else {
      sy = (ih - (iw * cRatio)) / 2;
      ih = iw * cRatio;
    }
    //*/
    ctx.drawImage(i, sx, sy, iw, ih, 0, 0, cw, ch);
  }
  </script>
</body>

</html>